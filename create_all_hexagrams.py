from docx import Document
from pathlib import Path

# 64괘 정보 (괘번호: (괘이름, 이진코드, 한자명))
hexagrams = {
    2: ("2괘", "222222", "곤위지(坤爲地)"),
    3: ("3괘", "212211", "수뢰둔(水雷屯)"),
    4: ("4괘", "122121", "산수몽(山水蒙)"),
    5: ("5괘", "212111", "수천수(水天需)"),
    6: ("6괘", "111212", "천수송(天水訟)"),
    7: ("7괘", "222212", "지수사(地水師)"),
    8: ("8괘", "212222", "수지비(水地比)"),
    9: ("9괘", "111211", "풍천소축(風天小畜)"),
    10: ("10괘", "111122", "천택리(天澤履)"),
    11: ("11괘", "222111", "지천태(地天泰)"),
    12: ("12괘", "111222", "천지비(天地否)"),
    13: ("13괘", "111121", "천화동인(天火同人)"),
    14: ("14괘", "121111", "화천대유(火天大有)"),
    15: ("15괘", "222122", "지산겸(地山謙)"),
    16: ("16괘", "211222", "뢰지예(雷地豫)"),
    17: ("17괘", "122211", "택뢰수(澤雷隨)"),
    18: ("18괘", "122211", "산풍고(山風蠱)"),
    19: ("19괘", "222122", "지택림(地澤臨)"),
    20: ("20괘", "211222", "풍지관(風地觀)"),
    21: ("21괘", "121211", "화뢰서합(火雷噬嗑)"),
    22: ("22괘", "122121", "산화비(山火賁)"),
    23: ("23괘", "122222", "산지박(山地剝)"),
    24: ("24괘", "222211", "지뢰복(地雷復)"),
    25: ("25괘", "111211", "천뢰무망(天雷無妄)"),
    26: ("26괘", "122111", "산천대축(山天大畜)"),
    27: ("27괘", "122211", "산뢰이(山雷頤)"),
    28: ("28괘", "122211", "택풍대과(澤風大過)"),
    29: ("29괘", "212212", "감위수(坎爲水)"),
    30: ("30괘", "121121", "리위화(離爲火)"),
    31: ("31괘", "122122", "택산함(澤山咸)"),
    32: ("32괘", "211211", "뢰풍항(雷風恆)"),
    33: ("33괘", "111122", "천산둔(天山遯)"),
    34: ("34괘", "211111", "뢰천대장(雷天大壯)"),
    35: ("35괘", "121222", "화지진(火地晉)"),
    36: ("36괘", "222121", "지화명이(地火明夷)"),
    37: ("37괘", "211121", "풍화가인(風火家人)"),
    38: ("38괘", "121122", "화택규(火澤睽)"),
    39: ("39괘", "212122", "수산건(水山蹇)"),
    40: ("40괘", "211212", "뢰수해(雷水解)"),
    41: ("41괘", "122122", "산택손(山澤損)"),
    42: ("42괘", "211211", "풍뢰익(風雷益)"),
    43: ("43괘", "122111", "택천쾌(澤天夬)"),
    44: ("44괘", "111211", "천풍구(天風姤)"),
    45: ("45괘", "122222", "택지취(澤地萃)"),
    46: ("46괘", "222211", "지풍승(地風升)"),
    47: ("47괘", "122212", "택수곤(澤水困)"),
    48: ("48괘", "212211", "수풍정(水風井)"),
    49: ("49괘", "122121", "택화혁(澤火革)"),
    50: ("50괘", "121211", "화풍정(火風鼎)"),
    51: ("51괘", "211211", "진위뢰(震爲雷)"),
    52: ("52괘", "122122", "간위산(艮爲山)"),
    53: ("53괘", "211122", "풍산점(風山漸)"),
    54: ("54괘", "211122", "뢰택귀매(雷澤歸妹)"),
    55: ("55괘", "211121", "뢰화풍(雷火豊)"),
    56: ("56괘", "121122", "화산려(火山旅)"),
    57: ("57괘", "211211", "손위풍(巽爲風)"),
    58: ("58괘", "122122", "태위택(兌爲澤)"),
    59: ("59괘", "211212", "풍수환(風水渙)"),
    60: ("60괘", "212122", "수택절(水澤節)"),
    61: ("61괘", "211122", "풍택중부(風澤中孚)"),
    62: ("62괘", "211122", "뢰산소과(雷山小過)"),
    63: ("63괘", "212121", "수화기제(水火旣濟)"),
    64: ("64괘", "121212", "화수미제(火水未濟)")
}

def create_hexagram_doc(number, name, binary_code, chinese_name):
    """각 괘의 워드 문서를 생성하는 함수"""
    doc = Document()
    
    # 제목 추가
    doc.add_heading(f'{name} : {binary_code} : {chinese_name}', 0)
    
    # 전체 내용 (공란)
    doc.add_paragraph('전체 : ')
    doc.add_paragraph('')
    
    # 1효부터 6효까지 (공란)
    for i in range(1, 7):
        doc.add_paragraph(f'{i}효 : ')
        doc.add_paragraph('')
    
    # 전체 요약 (공란)
    doc.add_paragraph('전체 : ')
    doc.add_paragraph('')
    
    # 파일 저장
    doc.save(f'해석/{name}.docx')
    print(f"{name}.docx 파일이 생성되었습니다.")

def main():
    # 해석 폴더가 없으면 생성
    Path("해석").mkdir(exist_ok=True)
    
    print("64괘 워드 파일 생성을 시작합니다...")
    print("=" * 50)
    
    # 2괘부터 64괘까지 생성
    for number, (name, binary_code, chinese_name) in hexagrams.items():
        create_hexagram_doc(number, name, binary_code, chinese_name)
    
    print("=" * 50)
    print(f"총 {len(hexagrams)}개의 괘 파일이 생성되었습니다.")
    print("각 파일은 1괘와 동일한 형식으로 만들어졌으며, 내용은 공란으로 되어 있습니다.")
    print("필요에 따라 각 괘의 해석 내용을 채워넣으시면 됩니다.")

if __name__ == "__main__":
    main() 